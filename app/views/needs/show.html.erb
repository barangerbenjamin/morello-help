<div class="container">
  <div class="row center-form align-items-center">
    <div class="col-10 offset-1 col-md-6 offset-md-3 text-center font-weight-bolder mt-3 mb-3">
      <% if @need.user.photo.attached? %>
        <%= cl_image_tag @need.user.photo.key, class: "avatar-big avatar-show" %>
      <% else %>
        <i class="big fas fa-user-circle"></i>
      <% end %>
      <h4 class="font-weight-bolder mt-2"><%= @need.name.upcase %></h4>
      <% if @need.services.empty? %>
        <p><%= @need.user.first_name.upcase %> NEEDS YOUR HELP!</p>
      <% else %>
          <p>YOU ARE HELPING <%= @need.user.first_name.upcase %></p>
          <p>FROM THE <%= @need.user.complex.upcase %> COMPLEX</p>
          <p>FLAT <%= @need.user.flat_number %></p>
      <% end %>
      <p>HERE IS A LITTLE DESCRIPTION:</p>
      <p class="font-weight-normal text-muted"><em><%= @need.note %></em></p>
      <% if @need.services.empty? && current_user == @need.user %>
        <p>AWAITING SOMEONE TO HELP YOU</p>
      <% elsif @need.services.empty? %>
        <p>REMAINING TIME: <%= distance_of_time_in_words(DateTime.now, @need.end_time).upcase %><p>
        <p>IF YOU THINK YOU CAN HELP, CLICK ON THE ICON BELOW</p>
        <%= render "services/form" %>
      <% elsif @need.services.first.status == "helped" %>
        <p><%= @need.services.first.user.first_name.upcase %> HAS HELPED YOU.</p>
        <p>THE COST WAS: <%= humanized_money_with_symbol(@need.services.first.price) %></p>
        <p>PLEASE REIMBURSE AS SOON AS POSSIBLE</p>
        <p>ALREADY DONE? CLICK BELOW</p>
        <%= link_to "confirm", confirm_reimbursement_service_path(@need.services.first), method: :patch, class: "d-none" %>
        <div class="submit-line mt-2 justify-content-around" data-controller="form">
            <%= link_to "confirm", confirm_reimbursement_service_path(@need.services.first), method: :patch, class: "d-none p-0", data: { target: "form.submitLink", needuser: @need.user.first_name } %>
            <span class="fas fa-hand-holding-usd" data-action="click->form#confirmMoney"></span>
          </div>
      <% elsif @need.services.first.status == "helped" %>
        <p>A BIG THANK YOU FOR HELPING OUR COMMUNITY</p>
        <p>WE HAVE NOTIFIED <%= @need.user.first_name.upcase %> SO SHE CAN REIMBURSE YOU ASAP!</p>
        <p class="mt-2">HAVE A LOVELY DAY</p>
      <% elsif @need.services.first.status == "done" %>
        <p>A BIG THANK YOU FOR HELPING OUR COMMUNITY</p>
        <p><%= @need.user.first_name.upcase %> HAS REIMBURSED YOU</p>
        <p class="mt-2">HAVE A LOVELY DAY</p>
      <% else %>
        <p>THANK YOU FOR PLEDGING TO HELP <%= @need.user.first_name.upcase %><p>
        <p>FILL THIS SMALL FORM WHEN YOU'RE DONE<p>
        <%= simple_form_for @need.services.first, html: { class: "text-left need-form" } do |f| %>
          <%= f.input :price, label: "AMOUNT", hint: "HOW MUCH DID IT COST YOU?" %>
          <%= f.input :receipt, as: :file, label: "RECEIPT", hint: "UPLOAD A PICTURE OF YOUR RECEIT" %>
          <div class="submit-line mt-2 justify-content-around" data-controller="form">
            <%= f.button :submit, "HELP OUT", data: { target: "form.submitLink", needuser: @need.user.first_name }, class: "p-0 d-none" %>
            <span class="fas fa-arrow-right" data-action="click->form#confirm"></span>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>